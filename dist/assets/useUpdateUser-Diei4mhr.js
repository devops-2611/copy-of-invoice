import{r as I,g as D,ah as Z,j as r,aK as T,o as ee,v as se,s as te,aI as N,y as re,k as oe,K as ne,ad as w,x as le,I as ie,N as ae,R as k,a as B,f as ue,n as S,A as F,b as j,u as ce,af as de}from"./index-C9Ciycjy.js";import{e as L,f as V}from"./index.esm-DCdPUB21.js";import{S as pe,F as fe}from"./Select-DufhBURI.js";import{g as M,h as he}from"./helperFuntions-7H5wIplU.js";import{I as O}from"./InputBase-IkFEOTEJ.js";const me={multiple:!1},z=I.forwardRef((e,s)=>{const{onChange:o,children:t,multiple:l,accept:i,name:a,form:c,resetRef:n,disabled:h,capture:u,inputProps:g,...y}=D("FileButton",me,e),p=I.useRef(null),v=()=>{var m;!h&&((m=p.current)==null||m.click())},d=m=>{o(l?Array.from(m.currentTarget.files):m.currentTarget.files[0]||null)};return Z(n,()=>{p.current&&(p.current.value="")}),r.jsxs(r.Fragment,{children:[t({onClick:v,...y}),r.jsx("input",{style:{display:"none"},type:"file",accept:i,multiple:l,onChange:d,ref:T(s,p),name:a,form:c,capture:u,...g})]})});z.displayName="@mantine/core/FileButton";const ge=({value:e})=>r.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Array.isArray(e)?e.map(s=>s.name).join(", "):e==null?void 0:e.name}),ye={valueComponent:ge},b=ee((e,s)=>{const o=D("FileInput",ye,e),{unstyled:t,vars:l,onChange:i,value:a,defaultValue:c,multiple:n,accept:h,name:u,form:g,valueComponent:y,clearable:p,clearButtonProps:v,readOnly:d,capture:x,fileInputProps:m,rightSection:K,size:E,placeholder:Q,component:G,resetRef:H,classNames:R,styles:P,...Y}=o,A=I.useRef(null),{resolvedClassNames:$,resolvedStyles:W}=se({classNames:R,styles:P,props:o}),[f,U]=te({value:a,defaultValue:c,onChange:i,finalValue:n?[]:null}),_=Array.isArray(f)?f.length!==0:f!==null,J=K||(p&&_&&!d?r.jsx(N,{...v,variant:"subtle",onClick:()=>U(n?[]:null),size:E,unstyled:t}):null);I.useEffect(()=>{var C;(Array.isArray(f)&&f.length===0||f===null)&&((C=A.current)==null||C.call(A))},[f]);const X=y;return r.jsx(z,{onChange:U,multiple:n,accept:h,name:u,form:g,resetRef:T(A,H),disabled:d,capture:x,inputProps:m,children:C=>r.jsx(O,{component:G||"button",ref:s,rightSection:J,...C,...Y,__staticSelector:"FileInput",multiline:!0,type:"button",pointer:!0,__stylesApiProps:o,unstyled:t,size:E,classNames:R,styles:P,children:_?r.jsx(X,{value:f}):r.jsx(re.Placeholder,{__staticSelector:"FileInput",classNames:$,styles:W,children:Q})})})});b.classes=O.classes;b.displayName="@mantine/core/FileInput";const ve=b;/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var xe=oe("outline","eye","IconEye",[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]]);const be=({name:e,label:s,data:o,disabled:t})=>{const{values:l,errors:i,touched:a,setFieldValue:c}=L(),n={touched:a[e],error:i[e]};return r.jsx(V,{name:e,children:({field:h})=>r.jsx(pe,{...h,label:s,value:l[e]?l[e]:null,data:o,clearable:!0,onChange:u=>c(e,u),error:n.touched&&n.error?n.error:void 0,disabled:t,comboboxProps:{name:e}})})},Ee=[{label:"Super Admin",value:"superAdmin"},{label:"Admin",value:"admin"},{label:"Staff",value:"staff"},{label:"Support",value:"support"},{label:"Merchant",value:"merchant"},{label:"Driver",value:"driver"},{label:"Affiliate",value:"affiliate"}],Re=[{label:"Active",value:"active"},{label:"Suspended",value:"suspended"},{label:"Inactive",value:"inactive"}],Pe=({name:e,label:s,disabled:o,accept:t="image/*",maxSize:l=5})=>{const{values:i,errors:a,touched:c,setFieldValue:n,setFieldError:h}=L(),u={touched:c[e],error:a[e]},[g,{close:y,open:p}]=ne(!1),v=d=>{if(d){if(d.size/1024/1024>l){h(e,"File Size more than 2 MB not allowed"),n(e,null);return}n(e,d)}};return r.jsx(V,{name:e,children:({field:d})=>r.jsxs("div",{style:{position:"relative",width:"100%",display:"flex",alignItems:"flex-end",overflow:"visible"},children:[r.jsx(ve,{...d,label:s,accept:t,multiple:!1,value:i[e]||null,error:u.touched&&u.error?u.error:void 0,disabled:o,onChange:v,style:{width:"100%"},rightSectionProps:{style:{justifyContent:"flex-end"}},rightSection:r.jsxs(fe,{mr:2,children:[r.jsx(N,{size:"sm",onMouseDown:x=>x.preventDefault(),onClick:()=>{n(e,null)},"aria-label":"Clear value"}),r.jsxs(w,{position:"top",withArrow:!0,shadow:"md",opened:g,children:[r.jsx(w.Target,{children:r.jsx(le,{onMouseEnter:p,onMouseLeave:y,variant:"outline",children:r.jsx(xe,{})})}),r.jsx(w.Dropdown,{style:{pointerEvents:"none"},children:r.jsx(ie,{src:M(i[e]),alt:M(i[e])===void 0?"No Image":"Uploaded Image",style:{maxWidth:"150px",maxHeight:"150px"}})})]})]})}),u.touched&&u.error&&r.jsx(ae,{color:"red",title:"Error",onClose:()=>{},children:u.error})]})})},q=e=>new Promise((s,o)=>{const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>s(t.result),t.onerror=o}),Ae=async e=>{if(!e)throw new Error("No customer data or profile image provided");if(!e.profileImg)return F.POST(j.ADD_CUSTOMER_DETAILS_MANUALLY(),e);const s=await q(e.profileImg);return F.POST(j.ADD_CUSTOMER_DETAILS_MANUALLY(),{...e,profileImg:s})},Ue=()=>{const e=k();return B({mutationFn:async s=>await Ae(s),onSuccess:s=>{var o;e.invalidateQueries({queryKey:["Customers-Grid-data"]}),S.show({title:"Customer Added Successfully",message:(o=s==null?void 0:s.data)==null?void 0:o.message,color:"green",autoClose:5e3,position:"top-center"})},onError:s=>{var o,t;s instanceof ue?S.show({title:((t=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:t.error)??"Request Failed",message:"There was an error adding the customer.",color:"red",autoClose:5e3}):S.show({title:"Customer Addition Failed",message:"Something went wrong.",color:"red",autoClose:5e3})}})};async function Ce({updates:e}){var l,i;const s=j.EDIT_USER();if(((l=e[0])==null?void 0:l.profileImg)instanceof File){const a=await q((i=e[0])==null?void 0:i.profileImg);return F.PUT(s,{...e[0],profileImg:a})}const{profileImg:o,...t}=e[0];return F.PUT(s,t)}const _e=()=>{const e=k(),{user:s,UpdateAuthContextUser:o}=ce();return B({mutationFn:({updates:t})=>Ce({updates:t}),onSuccess:(t,l)=>{var i,a,c,n;S.show({title:"Success",message:"User detail updated successfully",color:"green",autoClose:2e3,position:"top-center"}),((a=(i=t==null?void 0:t.data)==null?void 0:i.user)==null?void 0:a.email)===(s==null?void 0:s.email)&&o((c=t==null?void 0:t.data)==null?void 0:c.user),e.invalidateQueries({queryKey:[`Users-Grid-${(n=l==null?void 0:l.updates[0])==null?void 0:n.role}-data`]})},onError:t=>{de.isAxiosError(t)?he(t):console.error("Non-Axios error:",t)}})};export{Pe as F,xe as I,be as a,Ee as b,Re as c,Ue as d,q as r,_e as u};
