import{r as m,E as I,F as v,A,b as F,H as k,K as E,j as s,d as N,T as D,U as O}from"./index-C9Ciycjy.js";import{R as P,a as K,D as z,T as j,B as x,b as V,d as h}from"./MUIThemeProvider-rthW6W32.js";import{A as u}from"./AppChipComponent-1TDGqaTD.js";import{c as W,f as B}from"./helperFuntions-7H5wIplU.js";import{I as H}from"./useUpdateUser-Diei4mhr.js";import"./index-D3fRiVGU.js";import"./index.esm-DCdPUB21.js";import"./InputBase-IkFEOTEJ.js";import"./FormikInputField-nlZqF9vi.js";import"./TextInput-BjPE68lS.js";import"./Select-DufhBURI.js";import"./Alert-v-SYRoNK.js";import"./LoadingOverlay-DEuuc4vr.js";import"./Title-DhQLflRm.js";import"./Stack-Dk_up6_e.js";function g(n){return k(n,"DD MMM YYYY hh:mm A").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const Y=n=>{let l={};return n==null||n.forEach(r=>{var a;Array.isArray(r.value)?l[r.id]=(a=r.value)==null?void 0:a.join(","):l[r.id]=r.value}),l},L=n=>{var i,o;let l="";const r=(i=n==null?void 0:n[0])==null?void 0:i.id,a=(o=n==null?void 0:n[0])==null?void 0:o.desc;if(r==="merchantName"&&!a?l="ascName":r==="merchantName"&&a?l="descName":r==="registrationDate"&&!a?l="ascRegistrationDate":r==="registrationDate"&&a&&(l="descRegistrationDate"),l)return{sort:l}},G=n=>{let l="",r="";const a=n==null?void 0:n.find(i=>i.id==="registrationDate");if(a&&Array.isArray(a==null?void 0:a.value)&&(l=a!=null&&a.value[0]?g(a==null?void 0:a.value[0]):"",r=a!=null&&a.value[1]?g(a==null?void 0:a.value[1]):""),l||r)return{startDate:l,endDate:r}};function w(n,l,r){const a={pageNo:r.pageIndex+1,limit:r.pageSize,...L(l),...Y(n),...G(n)};return A.GET(F.GET_MERCHANT_DETAILS(),{params:a})}const q=n=>{const{columnFilters:l,EnableQuery:r,sorting:a,pagination:i}=n,[o,d]=m.useState([]);return m.useEffect(()=>{r&&d(l)},[l,r]),I({queryKey:["Merchants-Grid-data",o,a,i],queryFn:()=>w(o,a,i),placeholderData:v,refetchOnMount:!0,refetchOnWindowFocus:!1,retry:2})},Q=[{key:"merchantId",name:"merchantId",fieldType:"Number",label:"Merchant ID",disabled:{disabledFieldForNew:!1,disableFieldForEdit:!0},hidden:{hideFieldForEDIT:!1,hideFieldForNEW:!0}},{key:"merchantName",name:"merchantName",fieldType:"Text",label:"Merchant Name"},{key:"merchantEmail",name:"merchantEmail",fieldType:"Text",label:"Email"},{key:"merchantMobile",name:"merchantMobile",fieldType:"Text",label:"Mobile"},{key:"deliveryOrdersComission",name:"deliveryOrdersComission",fieldType:"Number",label:"Delivery Orders Commission"},{key:"collectionOrdersComission",name:"collectionOrdersComission",fieldType:"Number",label:"Collection Orders Commission"},{key:"eatInComission",name:"eatInComission",fieldType:"Number",label:"Eat-In Commission"},{key:"logoImg",name:"logoImg",fieldType:"imageInput",label:"Logo Image"},{key:"registrationDate",name:"registrationDate",fieldType:"DateTimeRange",label:"Registration Date",disabled:{disabledFieldForNew:!1,disableFieldForEdit:!0}},{key:"registrationMethod",name:"registrationMethod",fieldType:"Select",label:"Registration Method",meta:{options:[{label:"Online",value:"Online"},{label:"Web",value:"Web"}]}},{key:"zone",name:"zone",fieldType:"Select",label:"Zone",meta:{options:[{label:"Chester",value:"Chester"},{label:"Manchester",value:"Manchester"},{label:"Birmingham",value:"Birmingham"},{label:"Wrexham",value:"Wrexham"},{label:"Ellesmere Port",value:"Ellesmere Port"},{label:"Mold",value:"Mold"},{label:"London",value:"London"},{label:"Birkenhead",value:"Birkenhead"},{label:"Wirral",value:"Wirral"}]}},{key:"taxRate",name:"taxRate",fieldType:"Number",label:"Tax Rate"},{key:"rating",name:"rating",fieldType:"Rating",label:"Rating"},{key:"isInHouseType",name:"isInHouseType",fieldType:"RadioGroupForBoolean",label:"Merchant Type",meta:{options:[{label:"In House",value:"true"},{label:"Outsource",value:"false"}]}},{key:"serviceFeeApplicable",name:"serviceFeeApplicable",fieldType:"Checkbox",label:"Service Fee Applicable"},{key:"deliveryChargeApplicable",name:"deliveryChargeApplicable",fieldType:"Checkbox",label:"Delivery Charge Applicable"},{key:"driverTipApplicable",name:"driverTipApplicable",fieldType:"Checkbox",label:"Driver Tip Applicable"},{key:"isEmailApplicable",name:"isEmailApplicable",fieldType:"Checkbox",label:"Is Email Applicable"},{key:"isActive",name:"isActive",fieldType:"Checkbox",label:"Is Active"},{key:"merchantAddress",name:"merchantAddress",fieldType:"Section",label:"Merchant Address",fieldsInSection:[{key:"merchantAddress.line1",name:"merchantAddress.line1",fieldType:"Text",label:"Line 1"},{key:"merchantAddress.line2",name:"merchantAddress.line2",fieldType:"Text",label:"Line 2"},{key:"merchantAddress.area",name:"merchantAddress.area",fieldType:"Text",label:"Area"},{key:"merchantAddress.city",name:"merchantAddress.city",fieldType:"Text",label:"City"},{key:"merchantAddress.post",name:"merchantAddress.post",fieldType:"Text",label:"Postal Code"},{key:"merchantAddress.country",name:"merchantAddress.country",fieldType:"Text",label:"Country"}]},{key:"merchantManagementInfo",name:"merchantManagementInfo",fieldType:"Section",label:"Merchant Management Info",fieldsInSection:[{key:"merchantManagementInfo.ownerName",name:"merchantManagementInfo.ownerName",fieldType:"Text",label:"Owner Name"},{key:"merchantManagementInfo.ownerPhone",name:"merchantManagementInfo.ownerPhone",fieldType:"Text",label:"Owner Phone"},{key:"merchantManagementInfo.ownerEmail",name:"merchantManagementInfo.ownerEmail",fieldType:"Text",label:"Owner Email"},{key:"merchantManagementInfo.managerName",name:"merchantManagementInfo.managerName",fieldType:"Text",label:"Manager Name"},{key:"merchantManagementInfo.managerPhone",name:"merchantManagementInfo.managerPhone",fieldType:"Text",label:"Manager Phone"},{key:"merchantManagementInfo.managerEmail",name:"merchantManagementInfo.managerEmail",fieldType:"Text",label:"Manager Email"}]}];function U({columnFiltervalue:n,setColumnFilterValue:l}){return s.jsxs(h.Group,{value:String(n),onChange:r=>l(r),label:"Filter by Merchant Type",size:"md",styles:{label:{fontWeight:"normal",color:"grey"},root:{borderBottom:"1px solid grey",paddingBottom:10}},children:[s.jsx(h,{value:"true",label:"In House",mt:10}),s.jsx(h,{value:"false",label:"Outsource",mt:5})]})}const Z=({cell:n})=>s.jsxs(x,{sx:{display:"flex",gap:"1rem",alignItems:"center",justifyContent:"center"},children:[s.jsx(D,{style:{cursor:"pointer"},children:n.getValue()}),s.jsx(V,{title:"View Merchant Details",placement:"top",children:s.jsx(O,{to:"/merchant/dashboard",style:{textDecoration:"none"},onClick:()=>localStorage.setItem("AdminOnMerchantProfile",JSON.stringify(n.getValue())),children:s.jsx(H,{color:"green"})})})]}),_=({cell:n,row:l})=>{var r;return s.jsx(x,{sx:a=>({whiteSpace:"normal",wordWrap:"break-word",maxWidth:"200px",overflowWrap:"break-word"}),children:B((r=l==null?void 0:l.original)==null?void 0:r.merchantAddress)})},de=()=>{var p,f,y;const[n,l]=m.useState([]),[r,a]=m.useState([]),[i,o]=m.useState({pageIndex:0,pageSize:50}),[d,{open:b,close:M}]=E(!1),{data:c,isError:T,isLoading:C}=q({columnFilters:n,EnableQuery:!d,sorting:r,pagination:i}),S=m.useMemo(()=>[{accessorKey:"merchantId",header:"Merchant ID",enableSorting:!1,maxSize:150,Cell:Z},{accessorKey:"merchantName",header:"Merchant Name",enableSorting:!0,maxSize:50},{accessorKey:"merchantEmail",header:"Email",enableSorting:!1,maxSize:100},{accessorKey:"merchantMobile",header:"Mobile",enableSorting:!1,maxSize:30},{accessorKey:"merchantAddress",header:"Address",enableSorting:!1,enableColumnFilter:!1,maxSize:200,Cell:_},{accessorKey:"registrationDate",header:"Registration Date",enableSorting:!0,accessorFn:e=>new Date(e.registrationDate),filterVariant:"datetime-range",Cell:({cell:e})=>W(e.getValue()),muiFilterDateTimePickerProps:{label:"Registration Date",timeSteps:{minutes:1}},maxSize:50},{accessorKey:"zone",header:"Zone",enableSorting:!1,maxSize:30,filterVariant:"multi-select",filterSelectOptions:[{label:"Chester",value:"Chester"},{label:"Manchester",value:"Manchester"},{label:"Birmingham",value:"Birmingham"},{label:"Wrexham",value:"Wrexham"},{label:"Ellesmere Port",value:"Ellesmere Port"},{label:"Mold",value:"Mold"},{label:"London",value:"London"},{label:"Birkenhead",value:"Birkenhead"},{label:"Wirral",value:"Wirral"}]},{accessorKey:"serviceFeeApplicable",header:"Service Fee Applicable",enableSorting:!1,maxSize:30,Cell:({cell:e})=>e.getValue()?"Yes":"No",enableColumnFilter:!1},{accessorKey:"deliveryChargeApplicable",header:"Delivery Charge Applicable",enableSorting:!1,maxSize:30,Cell:({cell:e})=>e.getValue()?"Yes":"No",enableColumnFilter:!1},{accessorKey:"driverTipApplicable",header:"Driver Tip Applicable",enableSorting:!1,maxSize:30,Cell:({cell:e})=>e.getValue()?"Yes":"No",enableColumnFilter:!1},{accessorKey:"deliveryOrdersComission",header:"Delivery Orders Commission (%)",enableSorting:!1,maxSize:220,enableColumnFilter:!1},{accessorKey:"collectionOrdersComission",header:"Collection Orders Commission (%)",enableSorting:!1,maxSize:220,enableColumnFilter:!1},{accessorKey:"eatInComission",header:"Eat-In Commission (%)",enableSorting:!1,maxSize:220,enableColumnFilter:!1},{accessorKey:"taxRate",header:"Tax Rate",enableSorting:!1,maxSize:30,enableColumnFilter:!1},{accessorKey:"totalOrders",header:"Total Orders",enableSorting:!1,maxSize:30,enableColumnFilter:!1},{accessorKey:"isInHouseType",header:"Merchant Type",enableSorting:!1,maxSize:30,Cell:({cell:e})=>s.jsx(u,{value:e.getValue()?"In House":"Outsource"}),Filter:({column:e})=>s.jsx(U,{columnFiltervalue:e==null?void 0:e.getFilterValue(),setColumnFilterValue:e==null?void 0:e.setFilterValue})},{accessorKey:"isEmailApplicable",header:"Email Applicable",enableSorting:!1,maxSize:70,enableColumnFilter:!1,Cell:({cell:e})=>e.getValue()?"Yes":"No"},{accessorKey:"isActive",header:"Is Active",enableSorting:!1,maxSize:30,filterVariant:"checkbox",muiFilterCheckboxProps:{size:"large"},Cell:({cell:e})=>s.jsx(u,{value:e.getValue()?"Active":"Inactive"})},{accessorKey:"rating",header:"Rating",enableSorting:!1,maxSize:30,Cell:({cell:e})=>s.jsx(P,{value:e.getValue(),readOnly:!0}),enableColumnFilter:!1},{accessorKey:"merchantManagementInfo.ownerName",header:"Owner Name",enableSorting:!1,enableColumnFilter:!1,accessorFn:e=>{var t;return((t=e==null?void 0:e.merchantManagementInfo)==null?void 0:t.ownerName)??""}},{accessorKey:"merchantManagementInfo.ownerPhone",header:"Owner Phone",enableSorting:!1,enableColumnFilter:!1,accessorFn:e=>{var t;return((t=e==null?void 0:e.merchantManagementInfo)==null?void 0:t.ownerPhone)??""}},{accessorKey:"merchantManagementInfo.ownerEmail",header:"Owner Email",enableSorting:!1,enableColumnFilter:!1,accessorFn:e=>{var t;return((t=e==null?void 0:e.merchantManagementInfo)==null?void 0:t.ownerEmail)??""}},{accessorKey:"merchantManagementInfo.managerName",header:"Manager Name",enableSorting:!0,enableColumnFilter:!1,accessorFn:e=>{var t;return((t=e==null?void 0:e.merchantManagementInfo)==null?void 0:t.managerName)??""}},{accessorKey:"merchantManagementInfo.managerPhone",header:"Manager Phone",enableSorting:!1,enableColumnFilter:!1,accessorFn:e=>{var t;return((t=e==null?void 0:e.merchantManagementInfo)==null?void 0:t.managerPhone)??""}},{accessorKey:"merchantManagementInfo.managerEmail",header:"Manager Email",enableSorting:!1,enableColumnFilter:!1,accessorFn:e=>{var t;return((t=e==null?void 0:e.merchantManagementInfo)==null?void 0:t.managerEmail)??""}}],[]);return s.jsx(K,{children:s.jsx(m.Suspense,{fallback:s.jsx(N,{height:300,width:"100%"}),children:s.jsx(z,{data:((p=c==null?void 0:c.data)==null?void 0:p.merchant)??[],columnFilters:n,columns:S,pagination:i,sorting:r,totalRowCount:((f=c==null?void 0:c.data)==null?void 0:f.totalCount)??0,onColumnFiltersChange:l,onPaginationChange:o,onSortingChange:a,isLoading:C,OnFilterButtonClicked:()=>b(),OnApplyFiltersClicked:()=>M(),filterDrawerIsOpen:d,enableRowSelection:!0,isError:T,tableName:(y=j)==null?void 0:y.MerchantsDisplay,crudOperationHeader:"Merchant",columnPinning:{left:["mrt-row-select","mrt-row-actions","merchantId"]},uniqueIDForRows:"merchantId",uiSchema:Q})})})};export{de as default};
