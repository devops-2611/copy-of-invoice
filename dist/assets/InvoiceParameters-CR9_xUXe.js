import{p as Be,f as Ae,q as Se,j as e,B as Y,w as Le,x as $,_ as Re,$ as De,i as ve,M as Ce,a as fe,n as ge,A as be,b as Pe,r as S,P as Fe,G as T,e as z,v as Ve,D as Me,F as ue,Z as ke,a0 as _,L as Ne,a1 as He}from"./index-DJfC_LKA.js";import{F as $e,b as _e,f as H}from"./index.esm-D1SUAxcJ.js";import{c as Ue,j as U,k as j,g as n,f as o,I as Ye,F as ze,l as Ge,B as G,m as qe,n as k,q as je}from"./MUIThemeProvider-DlitpbUb.js";import{S as Qe,F as We}from"./FormikInputField-BCFqIq4V.js";import{d as Oe,i as Ie,c as pe}from"./helperFuntions-D5lYpqZv.js";import{T as N}from"./Title-CRBpu3gT.js";import{L as Ke}from"./LoadingOverlay-SsZ0EzDw.js";import{c as Ze}from"./useUpdateUser-DMboG7Aw.js";import{L as ye}from"./List-Dp--SsnA.js";var we={root:"m_347db0ec","root--dot":"m_fbd81e3d",label:"m_5add502a",section:"m_91fdda9b"};const Je={},Xe=Le((r,{radius:s,color:c,gradient:i,variant:u,size:x,autoContrast:h})=>{const a=r.variantColorResolver({color:c||r.primaryColor,theme:r,gradient:i,variant:u||"filled",autoContrast:h});return{root:{"--badge-height":$(x,"badge-height"),"--badge-padding-x":$(x,"badge-padding-x"),"--badge-fz":$(x,"badge-fz"),"--badge-radius":s===void 0?void 0:Re(s),"--badge-bg":c||u?a.background:void 0,"--badge-color":c||u?a.color:void 0,"--badge-bd":c||u?a.border:void 0,"--badge-dot-color":u==="dot"?De(c,r):void 0}}}),Ee=Be((r,s)=>{const c=Ae("Badge",Je,r),{classNames:i,className:u,style:x,styles:h,unstyled:a,vars:d,radius:y,color:C,gradient:f,leftSection:P,rightSection:g,children:L,variant:O,fullWidth:I,autoContrast:R,circle:w,mod:E,...B}=c,b=Se({name:"Badge",props:c,classes:we,className:u,style:x,classNames:i,styles:h,unstyled:a,vars:d,varsResolver:Xe});return e.jsxs(Y,{variant:O,mod:[{block:I,circle:w,"with-right-section":!!g,"with-left-section":!!P},E],...b("root",{variant:O}),ref:s,...B,children:[P&&e.jsx("span",{...b("section"),"data-position":"left",children:P}),e.jsx("span",{...b("label"),children:L}),g&&e.jsx("span",{...b("section"),"data-position":"right",children:g})]})});Ee.classes=we;Ee.displayName="@mantine/core/Badge";/**
 * @license @tabler/icons-react v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var er=ve("outline","edit","IconEdit",[["path",{d:"M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1",key:"svg-0"}],["path",{d:"M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z",key:"svg-1"}],["path",{d:"M16 5l3 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.21.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Te=ve("outline","file-download","IconFileDownload",[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M12 17v-6",key:"svg-2"}],["path",{d:"M9.5 14.5l2.5 2.5l2.5 -2.5",key:"svg-3"}]]);const rr=Ue(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle"),nr=({updates:r})=>{const s=Pe.EDIT_MERCHANT_INVOICE();return be.PUT(s,r)},sr=()=>{const r=Ce();return fe({mutationFn:({updates:s})=>nr({updates:s}),onSuccess:s=>{var c;ge.show({title:"Invoice Update",message:((c=s==null?void 0:s.data)==null?void 0:c.message)??"Invoice updated successfully",color:"green",autoClose:2e3,position:"top-center"}),r.invalidateQueries({queryKey:["All_Invoices-Grid-data"]})},onError:s=>{Oe(s)}})};function ir(){var y,C,f,P,g,L,O,I,R,w,E,B,b;const{values:r,setFieldValue:s}=H(),c=t=>{var l,m,p,v;s("invoiceParameters",{...r==null?void 0:r.invoiceParameters,calculationsByOrderType:{...(l=r==null?void 0:r.invoiceParameters)==null?void 0:l.calculationsByOrderType,MISCELLANEOUS:((v=(p=(m=r==null?void 0:r.invoiceParameters)==null?void 0:m.calculationsByOrderType)==null?void 0:p.MISCELLANEOUS)==null?void 0:v.filter((D,A)=>A!==t))??[]}})},i=()=>{var t,l,m;return s("invoiceParameters",{...r==null?void 0:r.invoiceParameters,calculationsByOrderType:{...(t=r==null?void 0:r.invoiceParameters)==null?void 0:t.calculationsByOrderType,MISCELLANEOUS:[...((m=(l=r==null?void 0:r.invoiceParameters)==null?void 0:l.calculationsByOrderType)==null?void 0:m.MISCELLANEOUS)??[],{amount:0,text:"",isVatApplicable:!0}]}})},{calculationsByOrderType:u,validItem:x,isInHouseType:h}=r.invoiceParameters;S.useEffect(()=>{const t=l=>{var v,D,A,F,V,M;const m=(A=(D=(v=r.invoiceParameters)==null?void 0:v.calculationsByOrderType)==null?void 0:D[l])==null?void 0:A.totalOrderValue,p=(M=(V=(F=r.invoiceParameters)==null?void 0:F.calculationsByOrderType)==null?void 0:V[l])==null?void 0:M.commissionRate;return m===void 0||p===void 0?0:m*.01*p};Object.hasOwn(r.invoiceParameters.calculationsByOrderType,"DELIVERY")&&s("invoiceParameters.calculationsByOrderType.DELIVERY.amount",t("DELIVERY")),Object.hasOwn(r.invoiceParameters.calculationsByOrderType,"COLLECTION")&&s("invoiceParameters.calculationsByOrderType.COLLECTION.amount",t("COLLECTION"))},[(C=(y=r.invoiceParameters.calculationsByOrderType)==null?void 0:y.DELIVERY)==null?void 0:C.totalOrderValue,(P=(f=r.invoiceParameters.calculationsByOrderType)==null?void 0:f.COLLECTION)==null?void 0:P.totalOrderValue,(L=(g=r.invoiceParameters.calculationsByOrderType)==null?void 0:g.DELIVERY)==null?void 0:L.commissionRate,(I=(O=r.invoiceParameters.calculationsByOrderType)==null?void 0:O.COLLECTION)==null?void 0:I.commissionRate]);const a=[...Object.entries(u).map(([t,l])=>{var p,v,D,A,F,V,M,q,Q,W,K,Z,J,X,ee,re,ne,se,ie,oe,ae,te,le,ce,de,xe,he,me;let m=null;if(t==="COLLECTION")m=e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(T,{children:[e.jsx(o,{children:`${l.commissionRate}% Commission on Collection Orders value`}),e.jsx(j,{name:"invoiceParameters.calculationsByOrderType.COLLECTION.totalOrderValue",label:"",extraProps:{prefix:"£",maw:"100px"}})]})}),e.jsx(n.Td,{children:e.jsx(o,{children:(A=(D=(v=(p=r==null?void 0:r.invoiceParameters)==null?void 0:p.calculationsByOrderType)==null?void 0:v[t])==null?void 0:D.amount)==null?void 0:A.toFixed(2)})})]});else if(t==="DELIVERY")m=e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(T,{children:[e.jsx(o,{children:`${l.commissionRate}% Commission on Delivery Orders value`}),e.jsx(j,{name:"invoiceParameters.calculationsByOrderType.DELIVERY.totalOrderValue",label:"",extraProps:{prefix:"£",maw:"100px"}})]})}),e.jsx(n.Td,{children:e.jsx(o,{children:(q=(M=(V=(F=r==null?void 0:r.invoiceParameters)==null?void 0:F.calculationsByOrderType)==null?void 0:V[t])==null?void 0:M.amount)==null?void 0:q.toFixed(2)})})]});else if(t==="SERVICE_FEE"&&!l.isCashOrders)m=e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(o,{children:["Service Fee Paid (",l.totalOrders," Orders)"]})}),e.jsx(n.Td,{children:e.jsx(o,{children:(Z=(K=(W=(Q=r==null?void 0:r.invoiceParameters)==null?void 0:Q.calculationsByOrderType)==null?void 0:W[t])==null?void 0:K.amount)==null?void 0:Z.toFixed(2)})})]});else if(t==="SERVICE_FEE"&&l.isCashOrders)m=e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(o,{children:["Service Fee Paid By Cash Orders (",l.totalOrders," Orders)"]})}),e.jsx(n.Td,{children:e.jsx(o,{children:(re=(ee=(X=(J=r==null?void 0:r.invoiceParameters)==null?void 0:J.calculationsByOrderType)==null?void 0:X[t])==null?void 0:ee.amount)==null?void 0:re.toFixed(2)})})]});else if(t==="DELIVERY_CHARGE"&&!l.isCashOrders&&!h)m=e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(o,{children:["Delivery Charge (",l.totalOrders," Orders)"]})}),e.jsx(n.Td,{children:e.jsx(o,{children:(oe=(ie=(se=(ne=r==null?void 0:r.invoiceParameters)==null?void 0:ne.calculationsByOrderType)==null?void 0:se[t])==null?void 0:ie.amount)==null?void 0:oe.toFixed(2)})})]});else if(t==="DELIVERY_CHARGE"&&l.isCashOrders&&!h)m=e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(o,{children:["Delivery Charge Paid By Cash Orders (",l.totalOrders," Orders)"]})}),e.jsx(n.Td,{children:e.jsx(o,{children:(ce=(le=(te=(ae=r==null?void 0:r.invoiceParameters)==null?void 0:ae.calculationsByOrderType)==null?void 0:te[t])==null?void 0:le.amount)==null?void 0:ce.toFixed(2)})})]});else if(t==="DRIVER_TIP"&&!h)m=e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(o,{children:["Driver Tip (",l.totalOrders," Orders)"]})}),e.jsx(n.Td,{children:e.jsx(o,{children:(me=(he=(xe=(de=r==null?void 0:r.invoiceParameters)==null?void 0:de.calculationsByOrderType)==null?void 0:xe[t])==null?void 0:he.amount)==null?void 0:me.toFixed(2)})})]});else if(t==="MISCELLANEOUS")return null;return m}),...(w=(R=r==null?void 0:r.invoiceParameters)==null?void 0:R.calculationsByOrderType)!=null&&w.MISCELLANEOUS&&((b=(B=(E=r==null?void 0:r.invoiceParameters)==null?void 0:E.calculationsByOrderType)==null?void 0:B.MISCELLANEOUS)==null?void 0:b.length)>0?r.invoiceParameters.calculationsByOrderType.MISCELLANEOUS.map((t,l)=>e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(T,{children:[e.jsx(Ve,{color:"red",variant:"subtle",onClick:m=>c(l),children:e.jsx(Ye,{})}),e.jsx(We,{name:`invoiceParameters.calculationsByOrderType.MISCELLANEOUS[${l}].text`,label:""}),e.jsx(ze,{name:`invoiceParameters.calculationsByOrderType.MISCELLANEOUS[${l}].isVatApplicable`,label:"VAT Applicable",RenderTextNodeforAlignment:!1})]})}),e.jsx(n.Td,{children:e.jsx(j,{name:`invoiceParameters.calculationsByOrderType.MISCELLANEOUS[${l}].amount`,label:"",extraProps:{prefix:"£",maw:"100px"}})})]},`MISCELLANEOUS ${l}`)):[],...x.length>0?x.map((t,l)=>e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(o,{children:[" ",`${t.itemName}, ${t.totalQuantity} Qty (Remaining £${t.balanceAmount.toFixed(2)})`]})}),e.jsx(n.Td,{children:e.jsx(j,{name:`invoiceParameters.validItem[${l}].deductableAmount`,label:"",extraProps:{prefix:"£",maw:"100px"}})})]},t._id)):[]],d=S.useMemo(()=>e.jsxs(n.Tr,{children:[e.jsx(n.Th,{children:"Description"}),e.jsx(n.Th,{children:"Amount"})]}),[]);return e.jsxs(Ge,{children:[e.jsxs(n,{captionSide:"bottom",withColumnBorders:!0,withRowBorders:!0,withTableBorder:!0,borderColor:"black",mt:20,children:[e.jsx(n.Thead,{children:d}),e.jsx(n.Tbody,{children:a})]}),e.jsx(z,{onClick:()=>i(),mt:10,variant:"outline",children:"Add Row in the table"})]})}function or(){var x,h,a,d,y;const{values:r}=H(),s=(x=r==null?void 0:r.invoiceParameters)==null?void 0:x.isInHouseType,c=(h=r==null?void 0:r.invoiceParameters)==null?void 0:h.deliveryChargeInHouse,i=(a=r==null?void 0:r.invoiceParameters)==null?void 0:a.driverTipInHouse,u=[e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsx(o,{children:"Total Orders"})}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.totalOrdersCount",label:"",extraProps:{maw:"100px"}})})]},"totalOrdersCount"),e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsx(o,{children:"Delivery Orders"})}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.deliveryOrderCount",label:"",extraProps:{maw:"100px"}})})]},"deliveryOrderCount"),e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsx(o,{children:"Collection Orders"})}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.collectionOrderCount",label:"",extraProps:{maw:"100px"}})})]},"collectionOrderCount"),e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(T,{children:[e.jsx(j,{name:"invoiceParameters.cardPaymentCount",label:"",extraProps:{maw:"100px"}})," ",e.jsx(o,{children:"Card Payments"})]})}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.cardPaymentAmount",label:"",extraProps:{prefix:"£",maw:"100px"}})})]},"cardPaymentAmount"),e.jsxs(n.Tr,{children:[e.jsxs(n.Td,{children:[e.jsxs(T,{children:[e.jsx(j,{name:"invoiceParameters.cashPaymentCount",label:"",extraProps:{maw:"100px"}})," ",e.jsx(o,{children:"Cash Payments (Including Service & Delivery Charges)"})]})," "]}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.cashPaymentAmount",label:"",extraProps:{prefix:"£",maw:"100px"}})})]},"cashPaymentAmount"),...s&&c?[e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(T,{children:[e.jsx(o,{children:"Own delivery charges ("}),e.jsx(j,{name:"invoiceParameters.deliveryChargeInHouse.totalOrders",label:"",extraProps:{maw:"100px"}}),e.jsx(o,{children:") orders"})]})}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.deliveryChargeInHouse.amount",label:"",extraProps:{prefix:"£",maw:"100px"}})})]},"isInHouseType_deliveryChargeInHouse")]:[],...s&&i?[e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsxs(T,{children:[e.jsx(o,{children:" Driver tip paid ("}),e.jsx(j,{name:"invoiceParameters.driverTipInHouse.totalOrders",label:"",extraProps:{maw:"100px"}}),e.jsx(o,{children:") orders"})]})}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.driverTipInHouse.amount",label:"",extraProps:{prefix:"£",maw:"100px"}})})]},"isInHouseType_driverTipInHouse")]:[],...Ie((d=r==null?void 0:r.invoiceParameters)==null?void 0:d.totalRefundAmount)?[e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsx(o,{children:"Refunds"})}),e.jsx(n.Td,{children:e.jsx(o,{children:(y=r==null?void 0:r.invoiceParameters)==null?void 0:y.totalRefundAmount})})]},"totalRefundAmount")]:[],e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsx(o,{children:"Total Sales"})}),e.jsx(n.Td,{children:e.jsx(j,{name:"invoiceParameters.totalSales",label:"",extraProps:{prefix:"£",maw:"100px"}})})]},"totalSales")];return e.jsxs(e.Fragment,{children:[e.jsx(N,{order:4,mt:20,mb:10,m:"auto",children:"Summary Table"}),e.jsx(n,{withColumnBorders:!0,withRowBorders:!0,withTableBorder:!0,borderColor:"black",children:e.jsx(n.Tbody,{children:u})})]})}function ar(){var u,x,h;const{values:r,setFieldValue:s}=H();S.useEffect(()=>{var d,y;const a=(y=(d=r==null?void 0:r.invoiceParameters)==null?void 0:d.refundArray)==null?void 0:y.reduce((C,f)=>C+f.refundAmount,0);Ie(a)&&s("invoiceParameters.totalRefundAmount",a)},[(u=r.invoiceParameters)==null?void 0:u.refundArray,s]);const c=(h=(x=r==null?void 0:r.invoiceParameters)==null?void 0:x.refundArray)==null?void 0:h.map((a,d)=>e.jsxs(n.Tr,{children:[e.jsx(n.Td,{children:e.jsx(o,{children:a==null?void 0:a.orderId})}),e.jsx(n.Td,{children:e.jsx(o,{children:Me(a==null?void 0:a.orderDate).format("DD MMM YYYY")})}),e.jsx(n.Td,{children:e.jsx(j,{name:`invoiceParameters.refundArray[${[d]}].refundAmount`})}),e.jsx(n.Td,{children:e.jsx(o,{children:a==null?void 0:a.invoiceId})})]},`refundTable${[d]}`)),i=S.useMemo(()=>e.jsxs(n.Tr,{children:[e.jsx(n.Th,{children:"order Id"}),e.jsx(n.Th,{children:"Order Date"}),e.jsx(n.Th,{children:"Refund Amount"}),e.jsx(n.Th,{children:"Invoice Id(if already billed)"})]}),[]);return e.jsxs(e.Fragment,{children:[e.jsx(N,{order:4,mt:20,mb:10,m:"auto",children:"Refund Summary"}),e.jsxs(n,{withColumnBorders:!0,withRowBorders:!0,withTableBorder:!0,borderColor:"black",children:[e.jsx(n.Thead,{children:i}),e.jsx(n.Tbody,{children:c})]})]})}function tr(){const{values:r}=H(),s=S.useMemo(()=>e.jsxs(n.Tr,{children:[e.jsx(n.Th,{w:"60%",children:e.jsx(o,{children:"Total Refund"})}),e.jsx(n.Th,{w:"40%",children:r==null?void 0:r.invoiceParameters.totalRefundAmount})]}),[r==null?void 0:r.invoiceParameters.totalRefundAmount]);return e.jsx(n,{withColumnBorders:!0,withRowBorders:!0,withTableBorder:!0,borderColor:"black",children:e.jsx(n.Thead,{children:s})})}const lr=r=>{const{closeModal:s,initialValues:c}=r,i=S.useRef(null),{mutateAsync:u,isPending:x,isSuccess:h}=sr(),a=d=>{u({updates:d})};return S.useEffect(()=>{h&&s()},[h]),e.jsxs(Fe,{p:"xl",shadow:"sm",withBorder:!0,w:"100%",pos:"relative",children:[e.jsx($e,{initialValues:c,onSubmit:a,innerRef:i,children:({values:d,setFieldValue:y})=>{var C,f;return e.jsx(_e,{children:e.jsxs(Qe,{w:"100%",children:[e.jsxs(N,{order:5,ta:"center",mb:20,c:"grey",children:["Invoice Id: ",d==null?void 0:d.invoiceId]}),e.jsx(Y,{children:e.jsx(U,{name:"invoiceParameters.invoiceDate",label:"Invoice Date"})}),e.jsxs(T,{children:[e.jsx(U,{name:"fromDate",label:"From Date"}),e.jsx(U,{name:"toDate",label:"To Date"})]}),e.jsx(ir,{}),e.jsx(or,{}),((f=(C=d==null?void 0:d.invoiceParameters)==null?void 0:C.refundArray)==null?void 0:f.length)&&e.jsxs(e.Fragment,{children:[e.jsx(ar,{}),e.jsx(Y,{w:"50%",children:e.jsx(tr,{})})]}),e.jsx(N,{order:4,mt:20,mb:10,m:"auto",children:"Account Section"}),e.jsxs(T,{children:[e.jsx(j,{name:"invoiceParameters.openingBalance",label:"Opening Balance",extraProps:{prefix:"£"}}),e.jsx(j,{name:"invoiceParameters.closingBalance",label:"Closing Balance",extraProps:{prefix:"£"}}),e.jsx(j,{name:"invoiceParameters.currentInvoiceCount",label:"Current Invoice Count"})]}),e.jsxs(T,{grow:!0,gap:"md",mt:20,children:[e.jsx(z,{type:"submit",loading:x,children:"Submit"}),e.jsx(z,{type:"reset",variant:"outline",disabled:x,children:"Reset"})]})]})})}}),e.jsx(Ke,{visible:x,zIndex:1e3,overlayProps:{radius:"sm",blur:2}})]})},cr=({invoiceId:r})=>{const s=`${Pe.VIEW_INVOICE_BY_MERCHANT()}?invoiceId=${r}`;return be.GET(s)},dr=()=>{const r=Ce();return fe({mutationFn:({invoiceId:s})=>cr({invoiceId:s}),onSuccess:s=>{var c;(c=s==null?void 0:s.data)!=null&&c.success&&r.invalidateQueries({queryKey:["All_Invoices-Grid-data"]})},onError:s=>{Oe(s)}})},xr=()=>{const{mutateAsync:r,isPending:s,variables:c}=dr();return{handleViewAndDownloadInvoice:async({invoiceId:u,downloadlink:x})=>{let h;try{await r({invoiceId:u}),h=window.open(x,"_blank","noopener,noreferrer")}catch(a){if(!h)throw new Error("Failed to open a new window. The browser may have blocked it.");a instanceof Error&&ge.show({title:"Error",message:a.message||"Failed to view or download the invoice.",color:"red"})}},isPending:s,variables:c}},hr=({label:r,value:s})=>e.jsxs(G,{children:[e.jsx(o,{variant:"body1",sx:{fontWeight:600},children:r}),e.jsx(o,{variant:"body2",color:"textSecondary",children:s})]}),gr=({row:r})=>{var O,I,R,w,E,B,b,t,l,m;const s=(O=r.original)==null?void 0:O.downloadLink,c=(I=r.original)==null?void 0:I.isEditable,i=(R=r.original)==null?void 0:R.invoiceParameters,[u,{open:x,close:h}]=ue(!1),{pathname:a}=ke(),{handleViewAndDownloadInvoice:d,isPending:y}=xr(),[C,{open:f,close:P}]=ue(!1),g=a==null?void 0:a.includes("accounting/invoices"),L=[{label:"Total Sales",value:`£${i==null?void 0:i.totalSales}`},{label:"Total Orders Count",value:i==null?void 0:i.totalOrdersCount},{label:"Delivery Orders",value:i==null?void 0:i.deliveryOrderCount},{label:"Collection Orders",value:i==null?void 0:i.collectionOrderCount},{label:`Card Payments (${i==null?void 0:i.cardPaymentCount})`,value:`£${i==null?void 0:i.cardPaymentAmount}`},{label:`Cash Payments (${i==null?void 0:i.cashPaymentCount})`,value:`£${i==null?void 0:i.cashPaymentAmount}`},{label:"Delivery Order Value",value:`£${i==null?void 0:i.deliveryOrderValue}`},{label:"Collection Order Value",value:`£${i==null?void 0:i.collectionOrderValue}`}];return e.jsxs(e.Fragment,{children:[e.jsx(G,{sx:{padding:1},children:e.jsxs(qe,{elevation:2,sx:{padding:2},children:[e.jsxs(Ze,{justify:"space-between",align:"flex-start",children:[e.jsxs(o,{variant:"h6",sx:{marginBottom:2,display:"flex",alignItems:"center"},children:[e.jsx(rr,{sx:{marginRight:1},color:"primary"}),"Invoice Summary"]}),((w=r.original)==null?void 0:w.isSentToMerchant)&&((E=r.original)==null?void 0:E.sentToMerchantAt)&&g&&e.jsxs(T,{mr:20,children:[e.jsxs(o,{variant:"subtitle1",style:{fontStyle:"italic"},children:["Sent to Merchant at"," ",pe((B=r.original)==null?void 0:B.sentToMerchantAt)]}),((t=(b=r.original)==null?void 0:b.viewHistory)==null?void 0:t.length)>0&&e.jsxs(_,{position:"top",withArrow:!0,shadow:"md",opened:C,children:[e.jsx(_.Target,{children:e.jsx(k,{onMouseEnter:f,onMouseLeave:P,variant:"outlined",children:"Seen History"})}),e.jsxs(_.Dropdown,{style:{pointerEvents:"none"},children:[e.jsx(o,{children:"Merchant Seen History :"}),e.jsx(ye,{mt:5,children:(m=(l=r.original)==null?void 0:l.viewHistory)==null?void 0:m.map(p=>e.jsx(ye.Item,{children:pe(p)},p))})]})]})]})]}),e.jsx(je,{sx:{marginBottom:2}}),e.jsx(G,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:2,marginBottom:2},children:L.map(p=>e.jsx(hr,{label:p.label,value:p.value},p.label))}),e.jsx(je,{sx:{marginTop:2}}),e.jsxs(T,{mt:20,align:"flex-end",children:[s&&g?e.jsx(k,{variant:"contained",href:s,target:"_blank",rel:"noopener noreferrer",sx:{marginTop:1},startIcon:e.jsx(Te,{}),children:"Download Invoice"}):e.jsx(k,{variant:"contained",color:"primary",onClick:()=>{var p,v;d({invoiceId:(p=r.original)==null?void 0:p.invoiceId,downloadlink:(v=r.original)==null?void 0:v.downloadLink})},startIcon:y?e.jsx(Ne,{size:"xs",color:"white"}):e.jsx(Te,{}),children:"Download Invoice"}),g&&c&&e.jsx(k,{variant:"outlined",color:"primary",onClick:x,sx:{marginTop:1},startIcon:e.jsx(er,{}),children:"EDIT INVOICE"})]})]})}),e.jsx(He,{opened:u,onClose:h,title:"",fullScreen:!0,radius:10,closeButtonProps:{iconSize:"lg"},transitionProps:{transition:"fade",duration:200},children:e.jsx(lr,{initialValues:r.original,closeModal:h})})]})};export{Ee as B,gr as I,sr as a,xr as u};
