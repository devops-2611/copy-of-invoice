import{E as C,F as Y,A,b as k,H as j,K as F,a2 as T,r as d,j as i,B as g,L as E,x as V,d as z}from"./index-BLIlmA3H.js";import{a as K,D as O,T as B}from"./MUIThemeProvider-C19IRQrA.js";import{u as H,I as N}from"./InvoiceParameters-D92NvBtj.js";import{a as h,c as G}from"./helperFuntions-DGUG679L.js";import{I as L}from"./useUpdateUser-w8Owpn5w.js";import"./index-BK5A5XBL.js";import"./index.esm-DfjObHCA.js";import"./InputBase-DX49xYkW.js";import"./FormikInputField-B2PJ7d2X.js";import"./TextInput-HlJqnerf.js";import"./Select-BzWorYtb.js";import"./Alert-D3dw1Im4.js";import"./LoadingOverlay-C_GBlKZb.js";import"./Title-DKWiMa_B.js";import"./Stack-C0tO9y16.js";import"./List-C2rtPsw9.js";function v(a){return j(a,"DD MMM YYYY").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const q=a=>{var n,o;let r="";const s=(n=a==null?void 0:a[0])==null?void 0:n.id,t=(o=a==null?void 0:a[0])==null?void 0:o.desc;if(s==="createdAt"&&!t?r="asc":s==="createdAt"&&t&&(r="desc"),r)return{sort:r}},Q=a=>{let r="",s="";const t=a==null?void 0:a.find(o=>o.id==="fromDate"),n=a==null?void 0:a.find(o=>o.id==="toDate");if(t&&(r=t!=null&&t.value?v(t==null?void 0:t.value):"",n&&(s=n!=null&&n.value?v(n==null?void 0:n.value):"")),r||s)return{startDate:r,endDate:s}};function _(a,r,s,t){const n={merchantId:a,pageNo:t.pageIndex+1,limit:t.pageSize,...q(s),...Q(r)};return A.GET(k.GET_MERCHANT_INVOICES_BY_ID(),{params:n})}const U=a=>{const{merchantId:r,columnFilters:s,EnableQuery:t,sorting:n,pagination:o}=a;return C({queryKey:["Invoices-of-Merchant",r,s,n,o],queryFn:()=>_(r,s,n,o),placeholderData:Y,enabled:t,refetchOnMount:!0,refetchOnWindowFocus:!1,retry:2})},le=()=>{var D,I;const[a,{open:r,close:s}]=F(!1),t=T(),[n,o]=d.useState([]),[m,x]=d.useState([]),[p,S]=d.useState({pageIndex:0,pageSize:50}),{data:l,isLoading:y,isError:M}=U({merchantId:t??"",columnFilters:n,EnableQuery:!a&&!!t,sorting:m,pagination:p}),{handleViewAndDownloadInvoice:b,isPending:f,variables:u}=H(),P=d.useMemo(()=>[{accessorKey:"invoiceId",header:"Invoice ID",enableSorting:!1,enableColumnFilter:!1,maxSize:30},{accessorKey:"fromDate",header:"From Date",enableSorting:!1,maxSize:50,accessorFn:e=>new Date(e==null?void 0:e.fromDate),Cell:({cell:e})=>h(e.getValue()),filterVariant:"date",muiFilterDatePickerProps:{label:"From Date",format:"DD MMM YYYY"}},{accessorKey:"toDate",header:"To Date",enableSorting:!1,maxSize:50,accessorFn:e=>new Date(e==null?void 0:e.toDate),Cell:({cell:e})=>h(e.getValue()),filterVariant:"date",muiFilterDatePickerProps:{format:"DD MMM YYYY",label:"To Date"}},{accessorKey:"downloadLink",header:"View Invoice",enableSorting:!1,enableColumnFilter:!1,maxSize:150,Cell:({cell:e,row:c})=>e.getValue()?i.jsx(g,{children:f&&(u==null?void 0:u.invoiceId)===c.original.invoiceId?i.jsx(E,{size:"sm"}):i.jsx(V,{variant:"transparent",onClick:()=>{b({invoiceId:c.original.invoiceId,downloadlink:e.getValue()})},children:i.jsx(L,{color:"green"})})}):"Not Available"},{accessorKey:"createdAt",header:"Created At",enableSorting:!0,enableColumnFilter:!1,maxSize:50,accessorFn:e=>new Date(e==null?void 0:e.createdAt),Cell:({cell:e})=>G(e.getValue()),muiFilterDateTimePickerProps:{label:"Created At"},meta:{fieldType:"DateTimeRange"}}],[f]);return i.jsx(K,{children:i.jsx(d.Suspense,{fallback:i.jsx(z,{height:300,width:"100%"}),children:i.jsx(O,{data:((D=l==null?void 0:l.data)==null?void 0:D.invoices)??[],columnFilters:n,columns:P,pagination:p,sorting:m,totalRowCount:((I=l==null?void 0:l.data)==null?void 0:I.totalCount)??0,onColumnFiltersChange:o,onPaginationChange:S,onSortingChange:x,isLoading:y,OnFilterButtonClicked:()=>r(),OnApplyFiltersClicked:()=>s(),filterDrawerIsOpen:a,isError:M,tableName:B.MerchantInvoicesData,crudOperationHeader:"Invoices",columnPinning:{},uniqueIDForRows:"downloadLink",enableRowActions:!1,muiExpandButtonProps:({row:e,table:c})=>({onClick:()=>c.setExpanded({[e.id]:!e.getIsExpanded()}),sx:{transform:e.getIsExpanded()?"rotate(180deg)":"rotate(-90deg)",transition:"transform 0.2s"}}),renderDetailPanel:({row:e})=>{var c;return(c=e.original)!=null&&c.invoiceParameters?i.jsx(N,{row:e}):null}})})})};export{le as default};
