import{r as o,Q as k,S,M,j as t,a2 as F,N as D,X as I}from"./index-RjG4LQGH.js";import{u as E,A as z,a as N}from"./ApiConstants-BlVjOu42.js";import{B as f,T as O,a as j,D as R,R as h}from"./MUIThemeProvider-BssgyMmN.js";import{A as g}from"./AppChipComponent-Dx1H5iu_.js";import{f as K,R as P}from"./helperFuntions-S9FCVSn8.js";import{T as V}from"./Text-BOu5SLtn.js";import"./DateTimePicker-DilR025a.js";import"./index.esm-h1T49CX-.js";import"./Alert-DRF9a1Jv.js";import"./Title-j2h2VxrO.js";function x(l){return S(l,"DD MMM YYYY hh:mm A").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const W=l=>{let i={};return l==null||l.forEach(r=>{var e;Array.isArray(r.value)?i[r.id]=(e=r.value)==null?void 0:e.join(","):i[r.id]=r.value}),i},Y=l=>{var s,n;let i="";const r=(s=l==null?void 0:l[0])==null?void 0:s.id,e=(n=l==null?void 0:l[0])==null?void 0:n.desc;if(r==="merchantName"&&!e?i="ascName":r==="merchantName"&&e?i="descName":r==="registrationDate"&&!e?i="ascRegistrationDate":r==="registrationDate"&&e&&(i="descRegistrationDate"),i)return{sort:i}},B=l=>{let i="",r="";const e=l==null?void 0:l.find(s=>s.id==="registrationDate");if(e&&Array.isArray(e==null?void 0:e.value)&&(i=e!=null&&e.value[0]?x(e==null?void 0:e.value[0]):"",r=e!=null&&e.value[1]?x(e==null?void 0:e.value[1]):""),i||r)return{startDate:i,endDate:r}};function w(l,i,r){const e={pageNo:r.pageIndex+1,limit:r.pageSize,...Y(i),...W(l),...B(l)};return z.GET(N.GET_MERCHANT_DETAILS(),{params:e})}const H=l=>{const{columnFilters:i,EnableQuery:r,sorting:e,pagination:s}=l,[n,m]=o.useState([]);return o.useEffect(()=>{r&&m(i)},[i,r]),E({queryKey:["Merchants-Grid-data",n,e,s],queryFn:()=>w(n,e,s),placeholderData:k,refetchOnMount:!1,refetchOnWindowFocus:!1,retry:2})},L=[{key:"merchantId",name:"merchantId",fieldType:"Number",label:"Merchant ID",disabled:{disabledFieldForNew:!1,disableFieldForEdit:!0},hidden:{hideFieldForEDIT:!1,hideFieldForNEW:!0}},{key:"merchantName",name:"merchantName",fieldType:"Text",label:"Merchant Name"},{key:"merchantEmail",name:"merchantEmail",fieldType:"Text",label:"Email"},{key:"merchantMobile",name:"merchantMobile",fieldType:"Text",label:"Mobile"},{key:"deliveryOrdersComission",name:"deliveryOrdersComission",fieldType:"Number",label:"Delivery Orders Commission"},{key:"collectionOrdersComission",name:"collectionOrdersComission",fieldType:"Number",label:"Collection Orders Commission"},{key:"eatInComission",name:"eatInComission",fieldType:"Number",label:"Eat-In Commission"},{key:"logoImg",name:"logoImg",fieldType:"imageInput",label:"Logo Image"},{key:"registrationDate",name:"registrationDate",fieldType:"DateTimeRange",label:"Registration Date",disabled:{disabledFieldForNew:!1,disableFieldForEdit:!0}},{key:"registrationMethod",name:"registrationMethod",fieldType:"Select",label:"Registration Method",meta:{options:[{label:"Online",value:"Online"},{label:"Web",value:"Web"}]}},{key:"zone",name:"zone",fieldType:"Select",label:"Zone",meta:{options:[{label:"Chester",value:"Chester"},{label:"Manchester",value:"Manchester"},{label:"Birmingham",value:"Birmingham"},{label:"Wrexham",value:"Wrexham"},{label:"Ellesmere Port",value:"Ellesmere Port"},{label:"Mold",value:"Mold"},{label:"London",value:"London"},{label:"Birkenhead",value:"Birkenhead"},{label:"Wirral",value:"Wirral"}]}},{key:"taxRate",name:"taxRate",fieldType:"Number",label:"Tax Rate"},{key:"rating",name:"rating",fieldType:"Rating",label:"Rating"},{key:"isInHouseType",name:"isInHouseType",fieldType:"RadioGroupForBoolean",label:"Merchant Type"},{key:"serviceFeeApplicable",name:"serviceFeeApplicable",fieldType:"Checkbox",label:"Service Fee Applicable"},{key:"deliveryChargeApplicable",name:"deliveryChargeApplicable",fieldType:"Checkbox",label:"Delivery Charge Applicable"},{key:"driverTipApplicable",name:"driverTipApplicable",fieldType:"Checkbox",label:"Driver Tip Applicable"},{key:"isEmailApplicable",name:"isEmailApplicable",fieldType:"Checkbox",label:"Is Email Applicable"},{key:"isActive",name:"isActive",fieldType:"Checkbox",label:"Is Active"},{key:"merchantAddress",name:"merchantAddress",fieldType:"Section",label:"Merchant Address",fieldsInSection:[{key:"merchantAddress.line1",name:"merchantAddress.line1",fieldType:"Text",label:"Line 1"},{key:"merchantAddress.line2",name:"merchantAddress.line2",fieldType:"Text",label:"Line 2"},{key:"merchantAddress.area",name:"merchantAddress.area",fieldType:"Text",label:"Area"},{key:"merchantAddress.city",name:"merchantAddress.city",fieldType:"Text",label:"City"},{key:"merchantAddress.post",name:"merchantAddress.post",fieldType:"Text",label:"Postal Code"},{key:"merchantAddress.country",name:"merchantAddress.country",fieldType:"Text",label:"Country"}]}];function G({columnFiltervalue:l,setColumnFilterValue:i}){return t.jsxs(h.Group,{value:String(l),onChange:r=>i(r),label:"Filter by Merchant Type",size:"md",styles:{label:{fontWeight:"normal",color:"grey"},root:{borderBottom:"1px solid grey",paddingBottom:10}},children:[t.jsx(h,{value:"true",label:"In House",mt:10}),t.jsx(h,{value:"false",label:"Outsource",mt:5})]})}const re=()=>{var b,y;const[l,i]=o.useState([]),[r,e]=o.useState([]),[s,n]=o.useState({pageIndex:0,pageSize:10}),[m,{open:p,close:v}]=M(!1),{data:d,isError:C,isLoading:T}=H({columnFilters:l,EnableQuery:!m,sorting:r,pagination:s}),A=o.useMemo(()=>[{accessorKey:"merchantId",header:"Merchant ID",enableSorting:!1,maxSize:150,Cell:({cell:a})=>t.jsxs(f,{sx:{display:"flex",gap:"1rem",alignItems:"center",justifyContent:"center"},children:[t.jsx(V,{style:{cursor:"pointer"},children:a.getValue()}),t.jsx(O,{title:"View Merchant Details",placement:"top",children:t.jsx(F,{to:`/merchant/${a.getValue()}/dashboard`,style:{textDecoration:"none"},children:t.jsx(D,{color:"green"})})})]})},{accessorKey:"merchantName",header:"Merchant Name",enableSorting:!0,maxSize:50},{accessorKey:"merchantEmail",header:"Email",enableSorting:!1,maxSize:100},{accessorKey:"merchantMobile",header:"Mobile",enableSorting:!1,maxSize:30},{accessorKey:"merchantAddress",header:"Address",enableSorting:!1,enableColumnFilter:!1,maxSize:200,Cell:({cell:a,row:c})=>{var u;return t.jsx(f,{sx:Q=>({whiteSpace:"normal",wordWrap:"break-word",maxWidth:"200px",overflowWrap:"break-word"}),children:K((u=c==null?void 0:c.original)==null?void 0:u.merchantAddress)})}},{accessorKey:"registrationDate",header:"Registration Date",enableSorting:!0,accessorFn:a=>new Date(a.registrationDate),filterVariant:"datetime-range",Cell:({cell:a})=>{const c=a.getValue();return S(c).format("DD MMM YYYY hh:mm A")},muiFilterDateTimePickerProps:{label:"Registration Date",timeSteps:{minutes:1}},maxSize:50},{accessorKey:"zone",header:"Zone",enableSorting:!1,maxSize:30,filterVariant:"multi-select",filterSelectOptions:[{label:"Chester",value:"Chester"},{label:"Manchester",value:"Manchester"},{label:"Birmingham",value:"Birmingham"},{label:"Wrexham",value:"Wrexham"},{label:"Ellesmere Port",value:"Ellesmere Port"},{label:"Mold",value:"Mold"},{label:"London",value:"London"},{label:"Birkenhead",value:"Birkenhead"},{label:"Wirral",value:"Wirral"}]},{accessorKey:"serviceFeeApplicable",header:"Service Fee Applicable",enableSorting:!1,maxSize:30,Cell:({cell:a})=>a.getValue()?"Yes":"No",enableColumnFilter:!1},{accessorKey:"deliveryChargeApplicable",header:"Delivery Charge Applicable",enableSorting:!1,maxSize:30,Cell:({cell:a})=>a.getValue()?"Yes":"No",enableColumnFilter:!1},{accessorKey:"driverTipApplicable",header:"Driver Tip Applicable",enableSorting:!1,maxSize:30,Cell:({cell:a})=>a.getValue()?"Yes":"No",enableColumnFilter:!1},{accessorKey:"deliveryOrdersComission",header:"Delivery Orders Commission (%)",enableSorting:!1,maxSize:220,enableColumnFilter:!1},{accessorKey:"collectionOrdersComission",header:"Collection Orders Commission (%)",enableSorting:!1,maxSize:220,enableColumnFilter:!1},{accessorKey:"eatInComission",header:"Eat-In Commission (%)",enableSorting:!1,maxSize:220,enableColumnFilter:!1},{accessorKey:"taxRate",header:"Tax Rate",enableSorting:!1,maxSize:30,enableColumnFilter:!1},{accessorKey:"totalOrders",header:"Total Orders",enableSorting:!1,maxSize:30,enableColumnFilter:!1},{accessorKey:"isInHouseType",header:"Merchant Type",enableSorting:!1,maxSize:30,Cell:({cell:a})=>t.jsx(g,{value:a.getValue()?"In House":"Outsource"}),Filter:({column:a})=>t.jsx(G,{columnFiltervalue:a==null?void 0:a.getFilterValue(),setColumnFilterValue:a==null?void 0:a.setFilterValue})},{accessorKey:"isEmailApplicable",header:"Email Applicable",enableSorting:!1,maxSize:70,enableColumnFilter:!1,Cell:({cell:a})=>a.getValue()?"Yes":"No"},{accessorKey:"isActive",header:"Is Active",enableSorting:!1,maxSize:30,filterVariant:"checkbox",muiFilterCheckboxProps:{size:"large"},Cell:({cell:a})=>t.jsx(g,{value:a.getValue()?"Active":"Inactive"})},{accessorKey:"rating",header:"Rating",enableSorting:!1,maxSize:30,Cell:({cell:a})=>t.jsx(P,{value:a.getValue(),readOnly:!0}),enableColumnFilter:!1}],[]);return t.jsx(j,{children:t.jsx(o.Suspense,{fallback:t.jsx(I,{height:300,width:"100%"}),children:t.jsx(R,{data:((b=d==null?void 0:d.data)==null?void 0:b.merchant)??[],columnFilters:l,columns:A,pagination:s,sorting:r,totalRowCount:((y=d==null?void 0:d.data)==null?void 0:y.totalCount)??0,onColumnFiltersChange:i,onPaginationChange:n,onSortingChange:e,isLoading:T,OnFilterButtonClicked:()=>p(),OnApplyFiltersClicked:()=>v(),filterDrawerIsOpen:m,enableRowSelection:!0,isError:C,tableName:"MerchantsDisplay",crudOperationHeader:"Merchant",columnPinning:{left:["mrt-row-select","mrt-row-actions","merchantId"]},uniqueIDForRows:"merchantId",uiSchema:L})})})};export{re as default};
