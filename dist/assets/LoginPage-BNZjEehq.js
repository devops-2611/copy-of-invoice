import{u as x,a as h,n as j,A as f,b as g,c as S,r as a,j as s,P as w,S as y,I as b,d as k,B as n,e as F}from"./index-QDmumIP4.js";import{c as C,a as m,F as L,b as P}from"./index.esm-DIYcYUZE.js";import{S as A,F as q}from"./FormikInputField-Bd876Pl6.js";import{F as v}from"./FormikPasswordField-pWwoAtHn.js";import{C as E}from"./Container-x0OucDPN.js";import{T as d}from"./Title-C0NKl79D.js";import{S as l}from"./Space-CVXwJAen.js";import{A as I}from"./Anchor-B9P3CWfP.js";import{A as U}from"./Alert-3nYhnQfH.js";import{L as B}from"./LoadingOverlay-C-xxoboR.js";import"./TextInput-DaGPfqTM.js";const N=async(r,e)=>{if(!r||!e)throw new Error("Query (email or username) and password are required");return f.POST(g.LOGIN_USER(),{query:r,password:e})},T=()=>{const{login:r}=x();return h({mutationFn:async({query:e,password:o})=>N(e,o),onSuccess:e=>{if(e!=null&&e.data.success){const{token:o,user:i}=(e==null?void 0:e.data)??{};localStorage.setItem("appToken",o),r(i),j.show({title:"Login Successful",message:`Welcome back, ${(i==null?void 0:i.firstName)??"User"}`,color:"green",autoClose:3e3,position:"top-center"})}}})},z={query:"",password:""},O=C({query:m().required("Email/Username is required"),password:m().required("Password is required")}),K=()=>{const{mutate:r,isPending:e,error:o}=T(),i=S(),u=a.useCallback(()=>{i("/auth/forgot-password")},[]),p=a.useCallback(t=>{r(t)},[]);return s.jsx(E,{size:"xs",mt:"xl",children:s.jsxs(w,{p:"xl",shadow:"sm",withBorder:!0,pos:"relative",children:[s.jsxs(A,{align:"center",children:[s.jsx(a.Suspense,{fallback:s.jsx(y,{height:200,width:200}),children:s.jsx(b,{h:120,w:"auto",fit:"contain",src:k})}),s.jsx(d,{order:4,mt:"sm",children:"Welcome to Swishr"})]}),s.jsx(l,{h:"md"}),s.jsx(n,{style:{display:"flex",justifyContent:"center"},children:s.jsx(d,{order:3,children:"Login"})}),s.jsx(L,{validationSchema:O,onSubmit:p,initialValues:z,children:()=>{var t,c;return s.jsxs(P,{children:[s.jsx(q,{name:"query",label:"Username/Email"}),s.jsx(l,{h:"md"}),s.jsx(v,{label:"Password",name:"password"}),s.jsx(n,{mt:"xs",style:{display:"flex",justifyContent:"flex-end"},children:s.jsx(I,{onClick:u,size:"sm",children:"Forgot Password?"})}),s.jsx(l,{h:"md"}),o&&s.jsx(U,{color:"red",mb:10,children:((c=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:c.message)??(o==null?void 0:o.message)}),s.jsx(n,{style:{display:"flex",justifyContent:"center"},children:s.jsx(F,{type:"submit",size:"md",loading:e,children:"Login"})})]})}}),s.jsx(B,{visible:e})]})})};export{K as default};
