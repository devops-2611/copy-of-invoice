import{y as P,z as Y,A,b as k,D as F,j as s,T as z,G as T,F as E,r as d,B as V,L as B,v as G,S as O}from"./index-BocbaNEA.js";import{a as K,D as N}from"./MUIThemeProvider-CweUhTdT.js";import{u as y,a as H}from"./useGetRelevantMerchantID-zIm8sDcY.js";import{C as L}from"./Container-BM-__z-f.js";import{B as h,u as q,I as Q}from"./InvoiceParameters-DmbHBOP_.js";import{D as _}from"./Rating-puGU3s4J.js";import{a as x,c as U}from"./helperFuntions-CM2HUrvq.js";import{I as W}from"./useUpdateUser-J2CWGRqD.js";import"./index.esm-BJmHqlnb.js";import"./FormikInputField-vBle5Dp0.js";import"./TextInput-WJD_G6xF.js";import"./index-DBElLul9.js";import"./Alert-BlMm2AM-.js";import"./LoadingOverlay-pZ8X-IXh.js";import"./Title-DvwRX8VF.js";import"./List-8a10eGoi.js";function v(a){return F(a,"DD MMM YYYY").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const w=a=>{var r,i;let n="";const o=(r=a==null?void 0:a[0])==null?void 0:r.id,t=(i=a==null?void 0:a[0])==null?void 0:i.desc;if(o==="createdAt"&&!t?n="asc":o==="createdAt"&&t&&(n="desc"),n)return{sort:n}},Z=a=>{let n="",o="";const t=a==null?void 0:a.find(i=>i.id==="fromDate"),r=a==null?void 0:a.find(i=>i.id==="toDate");if(t&&(n=t!=null&&t.value?v(t==null?void 0:t.value):"",r&&(o=r!=null&&r.value?v(r==null?void 0:r.value):"")),n||o)return{startDate:n,endDate:o}};function J(a,n,o,t){const r={merchantId:a,pageNo:t.pageIndex+1,limit:t.pageSize,...w(o),...Z(n)};return A.GET(k.GET_MERCHANT_INVOICES_BY_ID(),{params:r})}const X=a=>{const{merchantId:n,columnFilters:o,EnableQuery:t,sorting:r,pagination:i}=a;return P({queryKey:["Invoices-of-Merchant",n,o,r,i],queryFn:()=>J(n,o,r,i),placeholderData:Y,enabled:t,refetchOnMount:!0,refetchOnWindowFocus:!1,retry:2})};function $(){var o,t;const a=y(),{data:n}=H(a);return a?s.jsxs(s.Fragment,{children:[s.jsxs(T,{children:[s.jsxs(h,{size:"lg",variant:"dot",children:["Merchant ID :",a]}),s.jsx(h,{size:"lg",children:(t=(o=n==null?void 0:n.data)==null?void 0:o.merchant)==null?void 0:t.merchantName})]}),s.jsx(_,{mb:"md",mt:"md"})]}):s.jsx(L,{size:"lg",mt:30,className:"fallback-ui",children:s.jsx(z,{size:"xl",children:"Merchant ID is not provided"})})}const De=()=>{var D,I;const[a,{open:n,close:o}]=E(!1),t=y(),[r,i]=d.useState([]),[m,S]=d.useState([]),[f,M]=d.useState({pageIndex:0,pageSize:50}),{data:l,isLoading:b,isError:j}=X({merchantId:t??"",columnFilters:r,EnableQuery:!a&&!!t,sorting:m,pagination:f}),{handleViewAndDownloadInvoice:C,isPending:p,variables:u}=q(),g=d.useMemo(()=>[{accessorKey:"invoiceId",header:"Invoice ID",enableSorting:!1,enableColumnFilter:!1,maxSize:30},{accessorKey:"fromDate",header:"From Date",enableSorting:!1,maxSize:50,accessorFn:e=>new Date(e==null?void 0:e.fromDate),Cell:({cell:e})=>x(e.getValue()),filterVariant:"date",muiFilterDatePickerProps:{label:"From Date",format:"DD MMM YYYY"}},{accessorKey:"toDate",header:"To Date",enableSorting:!1,maxSize:50,accessorFn:e=>new Date(e==null?void 0:e.toDate),Cell:({cell:e})=>x(e.getValue()),filterVariant:"date",muiFilterDatePickerProps:{format:"DD MMM YYYY",label:"To Date"}},{accessorKey:"downloadLink",header:"View Invoice",enableSorting:!1,enableColumnFilter:!1,maxSize:150,Cell:({cell:e,row:c})=>e.getValue()?s.jsx(V,{children:p&&(u==null?void 0:u.invoiceId)===c.original.invoiceId?s.jsx(B,{size:"sm"}):s.jsx(G,{variant:"transparent",onClick:()=>{C({invoiceId:c.original.invoiceId,downloadlink:e.getValue()})},children:s.jsx(W,{color:"green"})})}):"Not Available"},{accessorKey:"createdAt",header:"Created At",enableSorting:!0,enableColumnFilter:!1,maxSize:50,accessorFn:e=>new Date(e==null?void 0:e.createdAt),Cell:({cell:e})=>U(e.getValue()),muiFilterDateTimePickerProps:{label:"Created At"},meta:{fieldType:"DateTimeRange"}}],[p]);return s.jsx(K,{children:s.jsxs(d.Suspense,{fallback:s.jsx(O,{height:300,width:"100%"}),children:[s.jsx($,{}),s.jsx(N,{data:((D=l==null?void 0:l.data)==null?void 0:D.invoices)??[],columnFilters:r,columns:g,pagination:f,sorting:m,totalRowCount:((I=l==null?void 0:l.data)==null?void 0:I.totalCount)??0,onColumnFiltersChange:i,onPaginationChange:M,onSortingChange:S,isLoading:b,OnFilterButtonClicked:()=>n(),OnApplyFiltersClicked:()=>o(),filterDrawerIsOpen:a,isError:j,tableName:"MerchantInvoicesData",crudOperationHeader:"Invoices",columnPinning:{},uniqueIDForRows:"downloadLink",enableRowActions:!1,muiExpandButtonProps:({row:e,table:c})=>({onClick:()=>c.setExpanded({[e.id]:!e.getIsExpanded()}),sx:{transform:e.getIsExpanded()?"rotate(180deg)":"rotate(-90deg)",transition:"transform 0.2s"}}),renderDetailPanel:({row:e})=>{var c;return(c=e.original)!=null&&c.invoiceParameters?s.jsx(Q,{row:e}):null}})]})})};export{De as default};
