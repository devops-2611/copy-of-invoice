import{r as l,y as v,z as x,A as E,b as D,D as g,F as A,j as c,S as I}from"./index-BocbaNEA.js";import{a as O,D as z}from"./MUIThemeProvider-CweUhTdT.js";import{c as P}from"./helperFuntions-CM2HUrvq.js";import"./index.esm-BJmHqlnb.js";import"./Rating-puGU3s4J.js";import"./FormikInputField-vBle5Dp0.js";import"./TextInput-WJD_G6xF.js";import"./useUpdateUser-J2CWGRqD.js";import"./index-DBElLul9.js";import"./Alert-BlMm2AM-.js";import"./LoadingOverlay-pZ8X-IXh.js";import"./Title-DvwRX8VF.js";function p(a){return g(a,"DD MMM YYYY hh:mm A").format("YYYY-MM-DDTHH:mm:ss.SSS[Z]")}const F=a=>{let t={};return a==null||a.forEach(r=>{var e;Array.isArray(r.value)?t[r.id]=(e=r.value)==null?void 0:e.join(","):t[r.id]=r.value}),t},K=a=>{var s,i;let t="";const r=(s=a==null?void 0:a[0])==null?void 0:s.id,e=(i=a==null?void 0:a[0])==null?void 0:i.desc;if(r==="createdAt"&&!e?t="ascDate":r==="createdAt"&&e&&(t="descDate"),t)return{sort:t}},T=a=>{let t="",r="";const e=a==null?void 0:a.find(s=>s.id==="createdAt");if(e&&Array.isArray(e==null?void 0:e.value)&&(t=e!=null&&e.value[0]?p(e==null?void 0:e.value[0]):"",r=e!=null&&e.value[1]?p(e==null?void 0:e.value[1]):""),t||r)return{startDate:t,endDate:r}};function M(a,t,r){const e={pageNo:r.pageIndex+1,limit:r.pageSize,...K(t),...F(a),...T(a)};return E.GET(D.GET_EMAIL_REPORT(),{params:e})}const j=a=>{const{columnFilters:t,EnableQuery:r,sorting:e,pagination:s}=a,[i,o]=l.useState([]);return l.useEffect(()=>{r&&o(t)},[t,r]),v({queryKey:["Email-Logs-Grid-data",i,e,s],queryFn:()=>M(i,e,s),placeholderData:x,refetchOnMount:!0,refetchOnWindowFocus:!1,retry:2})},_=()=>{var u,f;const[a,t]=l.useState([]),[r,e]=l.useState([]),[s,i]=l.useState({pageIndex:0,pageSize:50}),[o,{open:m,close:S}]=A(!1),{data:n,isError:y,isLoading:h}=j({columnFilters:a,EnableQuery:!o,sorting:r,pagination:s}),b=l.useMemo(()=>[{accessorKey:"receiverId",header:"Receiver Id",enableSorting:!1,maxSize:50},{accessorKey:"receiverName",header:"Receiver Name",enableSorting:!1,maxSize:100},{accessorKey:"orderId",header:"Order Id",enableSorting:!1,maxSize:200},{accessorKey:"emailId",header:"Email Id",enableSorting:!1,maxSize:300},{accessorKey:"emailType",header:"Email Type",enableSorting:!1,maxSize:100,filterVariant:"multi-select",filterSelectOptions:[{label:"Order Feedback",value:"orderFeedback"},{label:"Invoice",value:"invoice"}]},{accessorKey:"sendTo",header:"Receiver Type",enableSorting:!1,maxSize:50,filterVariant:"multi-select",filterSelectOptions:[{label:"Customer",value:"customer"},{label:"Merchant",value:"merchant"}]},{accessorKey:"createdAt",header:"Sent On",enableSorting:!0,accessorFn:d=>new Date(d.createdAt),filterVariant:"datetime-range",Cell:({cell:d})=>P(d.getValue()),muiFilterDateTimePickerProps:{label:"Sent On",timeSteps:{minutes:1}},maxSize:100},{accessorKey:"error",header:"Error(if any)",enableSorting:!1,maxSize:300,enableColumnFilter:!1},{accessorKey:"sendBy",header:"Send By",enableSorting:!1,maxSize:50,enableColumnFilter:!1},{accessorKey:"status",header:"Status",enableSorting:!1,maxSize:100,filterVariant:"multi-select",filterSelectOptions:[{label:"Processing",value:"processing"},{label:"Sent",value:"sent"},{label:"Failed",value:"falied"}]}],[]);return c.jsx(O,{children:c.jsx(l.Suspense,{fallback:c.jsx(I,{height:300,width:"100%"}),children:c.jsx(z,{data:((u=n==null?void 0:n.data)==null?void 0:u.logs)??[],columnFilters:a,columns:b,pagination:s,sorting:r,totalRowCount:((f=n==null?void 0:n.data)==null?void 0:f.totalCount)??0,onColumnFiltersChange:t,onPaginationChange:i,onSortingChange:e,isLoading:h,OnFilterButtonClicked:()=>m(),OnApplyFiltersClicked:()=>S(),filterDrawerIsOpen:o,isError:y,tableName:"EmailDisplay",crudOperationHeader:"Email",columnPinning:{left:["mrt-row-select","receiverName"],right:["status"]},uniqueIDForRows:"_id",enableRowActions:!1})})})};export{_ as default};
